<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>再生産関係の推定</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>再生産関係の推定</h1>

<ul>
<li>AICで比較したあと、フィットした再生産関係のプロットなどをみて、ちゃんと推定できてそうか確かめて下さい</li>
<li><a href="https://ichimomo.github.io/future-rvpa/SRR-guidline.html">モデル診断</a>も行って下さい。</li>
<li><strong>設定ポイント:</strong> get.SRdata関数のyearsの引数で、再生産関係をフィットさせたい年を指定します。何も指定しないと全年のデータが使われます。</li>
<li><strong>設定ポイント:</strong> ここで、将来予測で使う再生産関係を一つに決めます(SRmodel.baseに入れる)。</li>
</ul>

<h2>データの作成</h2>

<ul>
<li>get.SRdataを使って再生産関係のフィット用のデータを作る</li>
<li>get.SRdata関数では，<code>rownames(res_vpa$naa)</code>を参照し、必要な年齢分のSSBをずらしたデータを作成する</li>
<li>yearは加入年</li>
</ul>

<pre><code class="r"># ライブラリとデータの読み出し
library(frasyr)
data(res_vpa)
# VPA結果を使って再生産データを作る
SRdata &lt;- get.SRdata(res_vpa)
head(SRdata)
#&gt; $year
#&gt;  [1] 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001
#&gt; [15] 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015
#&gt; [29] 2016 2017
#&gt; 
#&gt; $SSB
#&gt;  [1] 12199.02 15266.68 15072.03 19114.22 23544.42 28769.36 34764.44
#&gt;  [8] 38219.49 48535.10 61891.08 63966.56 38839.78 53404.29 47322.39
#&gt; [15] 54485.00 54385.04 47917.14 46090.77 59847.97 53370.62 48781.21
#&gt; [22] 42719.43 40095.37 39311.68 38335.80 37563.79 27601.75 23069.26
#&gt; [29] 22866.36 21728.52
#&gt; 
#&gt; $R
#&gt;  [1]  406.0086  498.9652  544.3007  469.6025 1106.8877 1043.4237  696.7049
#&gt;  [8]  923.9567 1353.1790 1698.8457 1117.5454 2381.1352 1669.1381 1818.3638
#&gt; [15] 1858.0043 1458.9524 1334.9288 1116.9433 1100.4598 1693.9770 1090.7180
#&gt; [22] 1081.8375 1265.0554 1024.0379  753.5039  764.9276  879.5034  512.4936
#&gt; [29]  583.0853  710.2242
</code></pre>

<pre><code class="r"># SSBとRのデータだけを持っている場合
SRdata0 &lt;- get.SRdata(R.dat=exp(rnorm(10)),SSB.dat=exp(rnorm(10)))
# 特定の期間のデータだけを使う場合
SRdata0 &lt;- get.SRdata(res_vpa,years=1990:2000) 
</code></pre>

<h2>モデルのフィット</h2>

<ul>
<li>HS,BH,RIをフィットし，再生産関係のパラメータを推定する</li>
<li>結果のオブジェクトのAICcにAICcの値が入っているので，それを比較し，再生産関係を決定する</li>
<li>SR.fitオプション

<ul>
<li>SR:再生産関係のタイプ： &ldquo;HS&quot;（ホッケー・スティック）、&quot;BH&quot;（べバートン・ホルト）、&quot;RI&quot;（リッカー）</li>
<li>AR: 自己相関の考慮なし(AR=1)、過去１年分の自己相関を考慮(AR=1)
（１年分しか対応していない）</li>
<li>method: 最小二乗法（&quot;L2&rdquo;)か最小絶対値法（&quot;L1&quot;）</li>
<li><strong>自己相関あり・なしでAICcを比較し、自己相関を入れたほうがいいかどうか判断する</strong>

<ul>
<li>\(\log(R_t)=\log(HS(SSB_t))+\rho \times {\log(R_{t-1})-\log(HS(SSB_{t-1}))}\)</li>
<li>\(\log(R_t)~N(\log(R_t),\sigma^2)\)</li>
</ul></li>
<li><strong>自己相関パラメータrhoの推定については不安定な部分があります。計算方法の改善により今後値が変わる可能性があります</strong></li>
<li>この例の場合はHSでARなしで最もAICcが小さい→MSY計算ではHS.par0の結果を使う</li>
</ul></li>
</ul>

<pre><code class="r">HS.par0 &lt;- fit.SR(SRdata,SR=&quot;HS&quot;,method=&quot;L2&quot;,AR=0,hessian=FALSE)
HS.par1 &lt;- fit.SR(SRdata,SR=&quot;HS&quot;,method=&quot;L2&quot;,AR=1,hessian=FALSE)
BH.par0 &lt;- fit.SR(SRdata,SR=&quot;BH&quot;,method=&quot;L2&quot;,AR=0,hessian=FALSE)
BH.par1 &lt;- fit.SR(SRdata,SR=&quot;BH&quot;,method=&quot;L2&quot;,AR=1,hessian=FALSE)
RI.par0 &lt;- fit.SR(SRdata,SR=&quot;RI&quot;,method=&quot;L2&quot;,AR=0,hessian=FALSE)
RI.par1 &lt;- fit.SR(SRdata,SR=&quot;RI&quot;,method=&quot;L2&quot;,AR=1,hessian=FALSE)
c(HS.par0$AICc,HS.par1$AICc,BH.par0$AICc,BH.par1$AICc,RI.par0$AICc,RI.par1$AICc)
#&gt; [1] 10.79385 13.40053 11.19098 13.86183 11.14223 13.80250
</code></pre>

<ul>
<li>結果の図示</li>
</ul>

<pre><code class="r">plot_SRdata(SRdata)
lines(HS.par0$pred,col=2,type=&quot;l&quot;,lwd=3)
lines(BH.par0$pred,col=3,type=&quot;l&quot;,lwd=3)    
lines(RI.par0$pred,col=4,type=&quot;l&quot;,lwd=3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="図：**観測値（○）に対する再生産関係式．plot=赤がHS，緑と青がBH, RIだが両者はほとんど重なっていて見えない**"/></p>

<ul>
<li>TMBオプション(<code>TMB=TRUE</code>)も使えます（<strong>ちょっと不安定です。使いたい場合はお問い合わせください</strong>）\
<a href="http://cse.fra.affrc.go.jp/ichimomo/fish/autoregressiveSR2.cpp">autoregressiveSR2.cpp</a>をダウンロードして，作業フォルダに置く</li>
</ul>

<pre><code class="r"># install.packages(&quot;TMB&quot;)　#TMBがインストールされてなければ
#library(TMB)
#compile(&quot;autoregressiveSR2.cpp&quot;)
#dyn.load(dynlib(&quot;autoregressiveSR2&quot;))
#HS.par11 &lt;- fit.SR(SRdata,SR=&quot;HS&quot;,method=&quot;L2&quot;,AR=1,TMB=TRUE) #marginal likelihood
</code></pre>

<h2>モデル診断</h2>

<p>再生産関係のあてはめのあとは、推定されたパラメータの信頼区間や頑健性などをチェックする必要があります。そのための関数群なども用意しています。詳しくは<a href=https://ichimomo.github.io/future-rvpa/SRR-guidline.html> SRRガイドライン </a> へ</p>

<h1>将来予測</h1>

<p>future.vpa関数を使います</p>

<ul>
<li>recfuncの引数に再生産関係の関数を，rec.argにrecfuncに対する引数（再生産関係のパラメータ）を入れる</li>
<li>利用可能な再生産関数

<ul>
<li>HS.recAR: ホッケー・スティック＋加入は対数正規分布＋自己相関ありの場合も対応</li>
<li>RI.recAR・BH.recAR：HS.recARのリッカー・べバートンホルトバージョン</li>
<li>HS.rec, BH.rec, RI.rec : 残差リサンプリング用</li>
<li>RPS.simple.rec : RPSのリサンプリング。旧ルールに対応</li>
</ul></li>
</ul>

<pre><code class="r">fres.HS &lt;- future.vpa(res_vpa,
                      multi=1, # res_vpa$Fc.at.ageに掛ける乗数
                      nyear=50, # 将来予測の年数
                      start.year=2012, # 将来予測の開始年
                      N=100, # 確率的計算の繰り返し回数
                      ABC.year=2013, # ABCを計算する年
                      waa.year=2015:2017, # 生物パラメータの参照年
                      maa.year=2015:2017,
                      M.year=2015:2017,
                      is.plot=FALSE, # 結果をプロットするかどうか
                      seed=1,
                      silent=TRUE,
                      recfunc=HS.recAR, # 再生産関係の関数
                      # recfuncに対する引数
                      rec.arg=list(a=HS.par0$pars$a,b=HS.par0$pars$b,
                                   rho=HS.par0$pars$rho, # ここではrho=0なので指定しなくてもOK
                                   sd=HS.par0$pars$sd,resid=HS.par0$resid))
</code></pre>

<h2>将来予測で自己相関を考慮する場合</h2>

<pre><code class="r">fres.HS.AR &lt;- future.vpa(res_vpa,
                      multi=1,
                      nyear=50, # 将来予測の年数
                      start.year=2012, # 将来予測の開始年
                      N=100, # 確率的計算の繰り返し回数
                      ABC.year=2013, # ABCを計算する年
                      waa.year=2015:2017, # 生物パラメータの参照年
                      maa.year=2015:2017,
                      M.year=2015:2017,is.plot=FALSE, 
                      seed=1, silent=TRUE,recfunc=HS.recAR, 
                      # recfuncに対する引数 =&gt; 自己相関ありのオプションで計算した結果を入れる
                      rec.arg=list(a=HS.par1$pars$a,b=HS.par1$pars$b,
                                   rho=HS.par1$pars$rho, # 自己相関が高い場合、この値が&gt;0となる
                                   sd=HS.par1$pars$sd,
                                   resid=HS.par1$resid, # 再生産関係における残差の時系列
                                   resid.year=NULL # 近年の残差を何年分平均して将来予測に使うか？NULLの場合は、最後の年の残差を使う
                                   ) 
                      )
</code></pre>

<h2>Beverton-Holtを仮定する場合</h2>

<pre><code class="r">fres.BH &lt;- future.vpa(res_vpa,
                      multi=1,
                      nyear=50, # 将来予測の年数
                      start.year=2012, # 将来予測の開始年
                      N=100, # 確率的計算の繰り返し回数
                      ABC.year=2013, # ABCを計算する年
                      waa.year=2015:2017, # 生物パラメータの参照年
                      maa.year=2015:2017,
                      M.year=2015:2017,
                      is.plot=FALSE, # 結果をプロットするかどうか
                      seed=1,
                      silent=TRUE,
                      recfunc=BH.recAR, # 再生産関係の関数
                      # recfuncに対する引数
                      rec.arg=list(a=BH.par0$pars$a,b=BH.par0$pars$b,rho=BH.par0$rho,
                                   sd=BH.par0$pars$sd,resid=BH.par0$resid))
</code></pre>

<p>同じ引数を使ってもう一度将来予測をする</p>

<ul>
<li><code>fres.HS$input</code>に、将来予測で使った引数が入っているので、それにdo.call(関数、引数)すると同じ計算を繰り返せる</li>
</ul>

<pre><code class="r">fres.HS2 &lt;- do.call(future.vpa,fres.HS$input)
</code></pre>

<ul>
<li>fres.HS$inputを上書きすることで，同じ引数を使いながら設定を少しだけ変更した将来予測が実行できる</li>
<li>引数<code>multi</code>がcurrent Fへの乗数になる</li>
<li>たとえばmulti=1からmulti=0.5に変更する例は以下のとおり</li>
</ul>

<pre><code class="r"># 引数をinput.tmpに代入．
input.tmp &lt;- fres.HS2$input
# 引数の一部を変える
input.tmp$multi &lt;- 0.5 # current Fの1/2で漁獲
fres.HS3 &lt;- do.call(future.vpa,input.tmp)
</code></pre>

<p>plot.futures関数を使って複数の結果を比較</p>

<pre><code class="r">par(mfrow=c(2,2))
#plot.futures(list(fres.HS,fres.HS3),legend.text=c(&quot;F=Fcurrent&quot;,&quot;F=0.5Fcurrent&quot;),target=&quot;SSB&quot;)
#plot.futures(list(fres.HS,fres.HS3),legend.text=c(&quot;F=Fcurrent&quot;,&quot;F=0.5Fcurrent&quot;),target=&quot;Catch&quot;)
#plot.futures(list(fres.HS,fres.HS3),legend.text=c(&quot;F=Fcurrent&quot;,&quot;F=0.5Fcurrent&quot;),target=&quot;Biomass&quot;) 
</code></pre>

<h2>旧ルールで使っていたRPSのリサンプリングによる将来予測</h2>

<pre><code class="r">byear &lt;- 2015:2017 # 生物パラメータを平均する期間を2009年から2011年とする
rps.year &lt;- 2001:2011
fout.rps &lt;- future.vpa(res_vpa,currentF=NULL, multi=1, 
                    nyear=15,start.year=2012,N=10000,ABC.year=2013, 
                    waa.year=byear,maa.year=byear,M.year=byear,
                    rec.new=NULL,is.plot=FALSE,
                    recfunc=RPS.simple.rec,
                    rec.arg=list(rps.year=rps.year,
                      upper.ssb=Inf,bias.corrected=TRUE,rpsmean=FALSE,
                      upper.recruit=Inf))
#&gt; rec.arg$rho is assumed to be 0...
#&gt; $ABC.year
#&gt; [1] 2013
#&gt; 
#&gt; $Blim
#&gt; [1] 0
#&gt; 
#&gt; $F.sigma
#&gt; [1] 0
#&gt; 
#&gt; $Frec
#&gt; NULL
#&gt; 
#&gt; $HCR
#&gt; NULL
#&gt; 
#&gt; $M
#&gt; NULL
#&gt; 
#&gt; $M.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $N
#&gt; [1] 10000
#&gt; 
#&gt; $Pope
#&gt; [1] TRUE
#&gt; 
#&gt; $add.year
#&gt; [1] 0
#&gt; 
#&gt; $currentF
#&gt; NULL
#&gt; 
#&gt; $delta
#&gt; NULL
#&gt; 
#&gt; $det.run
#&gt; [1] TRUE
#&gt; 
#&gt; $eaa0
#&gt; NULL
#&gt; 
#&gt; $faa0
#&gt; NULL
#&gt; 
#&gt; $futureF
#&gt; NULL
#&gt; 
#&gt; $is.plot
#&gt; [1] FALSE
#&gt; 
#&gt; $maa
#&gt; NULL
#&gt; 
#&gt; $maa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $multi
#&gt; [1] 1
#&gt; 
#&gt; $multi.year
#&gt; [1] 1
#&gt; 
#&gt; $naa0
#&gt; NULL
#&gt; 
#&gt; $nyear
#&gt; [1] 15
#&gt; 
#&gt; $outtype
#&gt; [1] &quot;FULL&quot;
#&gt; 
#&gt; $plus.group
#&gt; [1] TRUE
#&gt; 
#&gt; $pre.catch
#&gt; NULL
#&gt; 
#&gt; $random.select
#&gt; NULL
#&gt; 
#&gt; $rec.arg
#&gt; $rec.arg$rps.year
#&gt;  [1] 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011
#&gt; 
#&gt; $rec.arg$upper.ssb
#&gt; [1] Inf
#&gt; 
#&gt; $rec.arg$bias.corrected
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$rpsmean
#&gt; [1] FALSE
#&gt; 
#&gt; $rec.arg$upper.recruit
#&gt; [1] Inf
#&gt; 
#&gt; 
#&gt; $rec.new
#&gt; NULL
#&gt; 
#&gt; $recfunc
#&gt; function (ssb, vpares, rec.arg = list(rps.year = NULL, upper.ssb = Inf, 
#&gt;     upper.recruit = Inf, sample.year = NULL, bias.correction = TRUE, 
#&gt;     rpsmean = FALSE), deterministic = FALSE, rec.resample = NULL) 
#&gt; {
#&gt;     if (is.null(rec.arg$bias.correction)) 
#&gt;         rec.arg$bias.correction &lt;- TRUE
#&gt;     if (is.null(rec.arg$rpsmean)) 
#&gt;         rec.arg$rpsmean &lt;- FALSE
#&gt;     if (is.null(rec.arg$rps.year)) 
#&gt;         rec.arg$rps.year &lt;- as.numeric(colnames(vpares$naa))
#&gt;     if (is.null(rec.arg$sample.year)) 
#&gt;         rec.arg$sample.year &lt;- rec.arg$rps.year
#&gt;     names(rec.arg)
#&gt;     if (is.null(rec.resample)) {
#&gt;         min.age &lt;- min(as.numeric(rownames(vpares$ssb)))
#&gt;         if (min.age == 0) 
#&gt;             slide.tmp &lt;- TRUE
#&gt;         else slide.tmp &lt;- -1:-min.age
#&gt;         rps.data &lt;- data.frame(year = years &lt;- as.numeric(names(colSums(vpares$ssb, 
#&gt;             na.rm = T))), ssb = SSB &lt;- as.numeric(colSums(vpares$ssb, 
#&gt;             na.rm = T)), recruit = rec &lt;- as.numeric(c(vpares$naa[1, 
#&gt;             slide.tmp], rep(NA, min.age))))
#&gt;         rps.data$rps &lt;- rps &lt;- rps.data$recruit/rps.data$ssb
#&gt;         rps.range &lt;- as.numeric(rps[years %in% rec.arg$rps.year])
#&gt;         rps.med &lt;- median(rps.range)
#&gt;         rps.mean &lt;- mean(rps.range)
#&gt;         rec.resample &lt;- as.numeric(rps[years %in% rec.arg$sample.year])
#&gt;     }
#&gt;     ssb.tmp &lt;- ifelse(ssb &gt; rec.arg$upper.ssb, rec.arg$upper.ssb, 
#&gt;         ssb)
#&gt;     rec_determine &lt;- ifelse(rec.arg$rpsmean, ssb.tmp * mean(rec.resample), 
#&gt;         ssb.tmp * median(rec.resample))
#&gt;     rec_random &lt;- sample(rec.resample, length(ssb.tmp) - 1, replace = TRUE) * 
#&gt;         ssb.tmp[-1]
#&gt;     if (rec.arg$bias.correction == TRUE) {
#&gt;         rec_random &lt;- rec_random * mean(rec.resample)/median(rec.resample)
#&gt;     }
#&gt;     rec &lt;- c(rec_determine, rec_random)
#&gt;     rec2 &lt;- ifelse(rec &gt; rec.arg$upper.recruit, rec.arg$upper.recruit, 
#&gt;         rec)
#&gt;     return(list(rec = rec2, rec.resample = rec.resample))
#&gt; }
#&gt; &lt;environment: namespace:frasyr&gt;
#&gt; 
#&gt; $replace.rec.year
#&gt; [1] 2012
#&gt; 
#&gt; $seed
#&gt; NULL
#&gt; 
#&gt; $silent
#&gt; [1] FALSE
#&gt; 
#&gt; $start.year
#&gt; [1] 2012
#&gt; 
#&gt; $use.MSE
#&gt; [1] FALSE
#&gt; 
#&gt; $waa
#&gt; NULL
#&gt; 
#&gt; $waa.catch
#&gt; NULL
#&gt; 
#&gt; $waa.fun
#&gt; [1] FALSE
#&gt; 
#&gt; $waa.year
#&gt; [1] 2015 2016 2017
</code></pre>

<h2>残差リサンプリング</h2>

<ul>
<li>残差リサンプリングで将来予測をする場合→refuncとしてHS.rec（ホッケー・スティック）、BH.rec（べバートン・ホルト）、RI.rec（リッカー）を使う</li>
<li>rec.argの引数で、<strong>必ず</strong> resample=TRUEとしてください。</li>
<li>rho&gt;0の場合には対応しておりません</li>
</ul>

<pre><code class="r"># 残差リサンプリングによる将来予測
fres.HS4 &lt;- future.vpa(res_vpa,
                          multi=1,
                          nyear=50, # 将来予測の年数
                          start.year=2012, # 将来予測の開始年
                          N=100, # 確率的計算の繰り返し回数
                          ABC.year=2013, # ABCを計算する年
                          waa.year=2015:2017, # 生物パラメータの参照年
                          maa.year=2015:2017,
                          M.year=2015:2017,
                          is.plot=FALSE, # 結果をプロットするかどうか
                          seed=1,
                          recfunc=HS.recAR, # 再生産関係の関数（HS.rec=Hockey-stick)                                
                          rec.arg=list(a=HS.par0$pars$a,b=HS.par0$pars$b,
                                       rho=HS.par0$pars$rho,
                                       sd=HS.par0$pars$sd,bias.correction=TRUE,
                                       resample=TRUE,resid=HS.par0$resid))
#&gt; $ABC.year
#&gt; [1] 2013
#&gt; 
#&gt; $Blim
#&gt; [1] 0
#&gt; 
#&gt; $F.sigma
#&gt; [1] 0
#&gt; 
#&gt; $Frec
#&gt; NULL
#&gt; 
#&gt; $HCR
#&gt; NULL
#&gt; 
#&gt; $M
#&gt; NULL
#&gt; 
#&gt; $M.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $N
#&gt; [1] 100
#&gt; 
#&gt; $Pope
#&gt; [1] TRUE
#&gt; 
#&gt; $add.year
#&gt; [1] 0
#&gt; 
#&gt; $currentF
#&gt; NULL
#&gt; 
#&gt; $delta
#&gt; NULL
#&gt; 
#&gt; $det.run
#&gt; [1] TRUE
#&gt; 
#&gt; $eaa0
#&gt; NULL
#&gt; 
#&gt; $faa0
#&gt; NULL
#&gt; 
#&gt; $futureF
#&gt; NULL
#&gt; 
#&gt; $is.plot
#&gt; [1] FALSE
#&gt; 
#&gt; $maa
#&gt; NULL
#&gt; 
#&gt; $maa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $multi
#&gt; [1] 1
#&gt; 
#&gt; $multi.year
#&gt; [1] 1
#&gt; 
#&gt; $naa0
#&gt; NULL
#&gt; 
#&gt; $nyear
#&gt; [1] 50
#&gt; 
#&gt; $outtype
#&gt; [1] &quot;FULL&quot;
#&gt; 
#&gt; $plus.group
#&gt; [1] TRUE
#&gt; 
#&gt; $pre.catch
#&gt; NULL
#&gt; 
#&gt; $random.select
#&gt; NULL
#&gt; 
#&gt; $rec.arg
#&gt; $rec.arg$a
#&gt; [1] 0.02886733
#&gt; 
#&gt; $rec.arg$b
#&gt; [1] 51483.48
#&gt; 
#&gt; $rec.arg$rho
#&gt; [1] 0
#&gt; 
#&gt; $rec.arg$sd
#&gt; [1] 0.2580955
#&gt; 
#&gt; $rec.arg$bias.correction
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$resample
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$resid
#&gt;  [1]  0.14230780  0.12415307  0.22395093 -0.16125648  0.48770817
#&gt;  [6]  0.22824101 -0.36494355 -0.17739094 -0.03478592  0.13373274
#&gt; [11] -0.28508161  0.75317713  0.11609110  0.28599825  0.22328667
#&gt; [16] -0.01849768 -0.03555058 -0.17497213 -0.30048819  0.13086270
#&gt; [21] -0.25546420 -0.13094807  0.08889985 -0.10272350 -0.38436055
#&gt; [26] -0.34897012  0.09876784 -0.26192346 -0.12404380  0.12424438
#&gt; 
#&gt; 
#&gt; $rec.new
#&gt; NULL
#&gt; 
#&gt; $recfunc
#&gt; function (ssb, vpares, rec.resample = NULL, rec.arg = list(a = 1000, 
#&gt;     b = 1000, sd = 0.1, rho = 0, resid = 0)) 
#&gt; {
#&gt;     rec0 &lt;- ifelse(ssb &gt; rec.arg$b, rec.arg$a * rec.arg$b, rec.arg$a * 
#&gt;         ssb)
#&gt;     rec &lt;- rec0 * exp(rec.arg$rho * rec.arg$resid)
#&gt;     rec &lt;- rec * exp(rnorm(length(ssb), -0.5 * rec.arg$sd2^2, 
#&gt;         rec.arg$sd))
#&gt;     new.resid &lt;- log(rec/rec0) + 0.5 * rec.arg$sd2^2
#&gt;     return(list(rec = rec, rec.resample = new.resid))
#&gt; }
#&gt; &lt;bytecode: 0x70d8ae8&gt;
#&gt; &lt;environment: namespace:frasyr&gt;
#&gt; 
#&gt; $replace.rec.year
#&gt; [1] 2012
#&gt; 
#&gt; $seed
#&gt; [1] 1
#&gt; 
#&gt; $silent
#&gt; [1] FALSE
#&gt; 
#&gt; $start.year
#&gt; [1] 2012
#&gt; 
#&gt; $use.MSE
#&gt; [1] FALSE
#&gt; 
#&gt; $waa
#&gt; NULL
#&gt; 
#&gt; $waa.catch
#&gt; NULL
#&gt; 
#&gt; $waa.fun
#&gt; [1] FALSE
#&gt; 
#&gt; $waa.year
#&gt; [1] 2015 2016 2017
#&gt; Warning in rec0 * exp(rec.arg$rho * rec.arg$resid): longer object length is
#&gt; not a multiple of shorter object length
</code></pre>

<p>残差リサンプリングか対数正規分布かの違いを比較</p>

<pre><code class="r">par(mfrow=c(2,2))
plot(fres.HS$vssb[,-1],fres.HS$naa[1,,-1],xlab=&quot;SSB&quot;,ylab=&quot;Recruits&quot;) 
plot(fres.HS4$vssb[,-1],fres.HS4$naa[1,,-1],xlab=&quot;SSB&quot;,ylab=&quot;Recruits&quot;) 
#plot.futures(list(fres.HS,fres.HS4)) # 両者の比較
</code></pre>

<h2>Fの設定とFrec</h2>

<p>将来予測における漁獲のシナリオ</p>

<ul>
<li>future.vpaの引数<code>ABC.year</code>で指定した年から，Fcurrent × multiによるFで漁獲される</li>
<li>ABC.year-1年まではFcurrentによる漁獲</li>
<li><em>Frecに引数を与えることで，任意の資源量に任意の確率で回復させるような将来予測ができます．</em></li>
</ul>

<p><strong>Frecのオプション</strong></p>

<table><thead>
<tr>
<th align="left">オプション</th>
<th align="left">説明</th>
</tr>
</thead><tbody>
<tr>
<td align="left">stochastic</td>
<td align="left">確率的将来予測をもとにFrecを計算するかどうか</td>
</tr>
<tr>
<td align="left">future.year</td>
<td align="left">条件を満たしているかどうかを判断する年</td>
</tr>
<tr>
<td align="left">Blimit</td>
<td align="left">条件として使われる閾値</td>
</tr>
<tr>
<td align="left">scenario</td>
<td align="left">=&ldquo;blimit&rdquo;: Blimitを<strong>下回る</strong>確率をtarget.probsにする</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">=&ldquo;catch.mean&rdquo;: future.year年の平均漁獲量をBlimitの値と一致させる</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">=&ldquo;ssb.mean&rdquo;: future.year年の平均親魚量をBlimitの値と一致させる</td>
</tr>
<tr>
<td align="left">target.probs</td>
<td align="left">scenario=&ldquo;blimit&quot;のときに目的とする確率（パーセントで指定）</td>
</tr>
<tr>
<td align="left">Frange</td>
<td align="left">探索するFの範囲．指定しない場合，c(0.01,multi*2)の範囲で探索しますので，うまく推定できない場合はfuture.vpaの引数multiを変えるか，このオプションでそれらしいFの値に限定してください</td>
</tr>
</tbody></table>

<pre><code class="r"># たとえば現状の資源量に維持するシナリオ
fres.currentSSB &lt;- future.vpa(res_vpa,
                      multi=0.8,
                      nyear=50, # 将来予測の年数
                      start.year=2012, # 将来予測の開始年
                      N=100, # 確率的計算の繰り返し回数
                      ABC.year=2013, # ABCを計算する年
                      waa.year=2015:2017, # 生物パラメータの参照年
                      maa.year=2015:2017,
                      M.year=2015:2017,seed=1,
                      is.plot=FALSE, # 結果をプロットするかどうか
                      Frec=list(stochastic=TRUE,future.year=2023,Blimit=rev(colSums(res_vpa$ssb))[1],scenario=&quot;blimit&quot;,target.probs=50),
                      recfunc=HS.recAR, # 再生産関係の関数
                      # recfuncに対する引数
                      rec.arg=list(a=HS.par0$pars$a,b=HS.par0$pars$b,
                                   rho=HS.par0$pars$rho,                                    
                                   sd=HS.par0$pars$sd,bias.corrected=TRUE))
#&gt; $ABC.year
#&gt; [1] 2013
#&gt; 
#&gt; $Blim
#&gt; [1] 0
#&gt; 
#&gt; $F.sigma
#&gt; [1] 0
#&gt; 
#&gt; $Frec
#&gt; $Frec$stochastic
#&gt; [1] TRUE
#&gt; 
#&gt; $Frec$future.year
#&gt; [1] 2023
#&gt; 
#&gt; $Frec$Blimit
#&gt;     2017 
#&gt; 21728.52 
#&gt; 
#&gt; $Frec$scenario
#&gt; [1] &quot;blimit&quot;
#&gt; 
#&gt; $Frec$target.probs
#&gt; [1] 50
#&gt; 
#&gt; 
#&gt; $HCR
#&gt; NULL
#&gt; 
#&gt; $M
#&gt; NULL
#&gt; 
#&gt; $M.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $N
#&gt; [1] 100
#&gt; 
#&gt; $Pope
#&gt; [1] TRUE
#&gt; 
#&gt; $add.year
#&gt; [1] 0
#&gt; 
#&gt; $currentF
#&gt; NULL
#&gt; 
#&gt; $delta
#&gt; NULL
#&gt; 
#&gt; $det.run
#&gt; [1] TRUE
#&gt; 
#&gt; $eaa0
#&gt; NULL
#&gt; 
#&gt; $faa0
#&gt; NULL
#&gt; 
#&gt; $futureF
#&gt; NULL
#&gt; 
#&gt; $is.plot
#&gt; [1] FALSE
#&gt; 
#&gt; $maa
#&gt; NULL
#&gt; 
#&gt; $maa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $multi
#&gt; [1] 0.8
#&gt; 
#&gt; $multi.year
#&gt; [1] 1
#&gt; 
#&gt; $naa0
#&gt; NULL
#&gt; 
#&gt; $nyear
#&gt; [1] 50
#&gt; 
#&gt; $outtype
#&gt; [1] &quot;FULL&quot;
#&gt; 
#&gt; $plus.group
#&gt; [1] TRUE
#&gt; 
#&gt; $pre.catch
#&gt; NULL
#&gt; 
#&gt; $random.select
#&gt; NULL
#&gt; 
#&gt; $rec.arg
#&gt; $rec.arg$a
#&gt; [1] 0.02886733
#&gt; 
#&gt; $rec.arg$b
#&gt; [1] 51483.48
#&gt; 
#&gt; $rec.arg$rho
#&gt; [1] 0
#&gt; 
#&gt; $rec.arg$sd
#&gt; [1] 0.2580955
#&gt; 
#&gt; $rec.arg$bias.corrected
#&gt; [1] TRUE
#&gt; 
#&gt; 
#&gt; $rec.new
#&gt; NULL
#&gt; 
#&gt; $recfunc
#&gt; function (ssb, vpares, rec.resample = NULL, rec.arg = list(a = 1000, 
#&gt;     b = 1000, sd = 0.1, rho = 0, resid = 0)) 
#&gt; {
#&gt;     rec0 &lt;- ifelse(ssb &gt; rec.arg$b, rec.arg$a * rec.arg$b, rec.arg$a * 
#&gt;         ssb)
#&gt;     rec &lt;- rec0 * exp(rec.arg$rho * rec.arg$resid)
#&gt;     rec &lt;- rec * exp(rnorm(length(ssb), -0.5 * rec.arg$sd2^2, 
#&gt;         rec.arg$sd))
#&gt;     new.resid &lt;- log(rec/rec0) + 0.5 * rec.arg$sd2^2
#&gt;     return(list(rec = rec, rec.resample = new.resid))
#&gt; }
#&gt; &lt;bytecode: 0x70d8ae8&gt;
#&gt; &lt;environment: namespace:frasyr&gt;
#&gt; 
#&gt; $replace.rec.year
#&gt; [1] 2012
#&gt; 
#&gt; $seed
#&gt; [1] 1
#&gt; 
#&gt; $silent
#&gt; [1] FALSE
#&gt; 
#&gt; $start.year
#&gt; [1] 2012
#&gt; 
#&gt; $use.MSE
#&gt; [1] FALSE
#&gt; 
#&gt; $waa
#&gt; NULL
#&gt; 
#&gt; $waa.catch
#&gt; NULL
#&gt; 
#&gt; $waa.fun
#&gt; [1] FALSE
#&gt; 
#&gt; $waa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; F multiplier= 1.20139
</code></pre>

<h2>年齢別体重が資源尾数に影響される場合</h2>

<ul>
<li><strong><em>future.vpaで，waa.fun = TRUEとすれば、年齢別資源重量が資源尾数（log(体重)~log(資源尾数)の回帰を関数内部で実行）の関数から予測されます</em></strong></li>
<li><strong><em>不確実性も考慮されます</em></strong></li>
<li>30系群であてはめた例は<a href="waa-lm.pdf">こちら</a> (データは1年分古いです)</li>
<li>太平洋マイワシ，対馬マイワシ，太平洋マサバ，ホッケ，瀬戸内サワラでは年齢別体重と年齢別資源尾数に関係がありそうなかんじです</li>
</ul>

<pre><code class="r">lm.res &lt;- plot_waa(res_vpa) # weight at ageが資源尾数の関数になっているかどうか，確認してみる．この例の場合は特に有意な関係はない
#&gt; Warning in summary.lm(lm.list[[i]]): essentially perfect fit: summary may
#&gt; be unreliable

#&gt; Warning in summary.lm(lm.list[[i]]): essentially perfect fit: summary may
#&gt; be unreliable

#&gt; Warning in summary.lm(lm.list[[i]]): essentially perfect fit: summary may
#&gt; be unreliable

#&gt; Warning in summary.lm(lm.list[[i]]): essentially perfect fit: summary may
#&gt; be unreliable
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/></p>

<pre><code class="r"># lm.resの中に回帰した結果が年齢分だけ入っています
fres.HS6 &lt;- fres.HS
fres.HS6$input$waa.fun &lt;- TRUE
fres.HS6$input$N &lt;- 1000
fres.HS6 &lt;- do.call(future.vpa, fres.HS6$input)
</code></pre>

<h2>その他のオプション</h2>

<ul>
<li><code>HCR=list(Blim=154500, Bban=49400,beta=1)</code> のように与えると、BlimからBbanまで直線的にFが減少するようなHCRで漁獲します。betaは、全体のFに掛ける乗数です。</li>
<li><code>pre.catch=list(year=2013,wcatch=13000)</code>のように与えると特定の年の漁獲量をwcatchで与えた漁獲量で固定します</li>
<li><code>rec.new=list(year=2012,rec=1500)</code>のように与えると、対応する年の加入を置き換えます。</li>
</ul>

<pre><code class="r">fres.HS5 &lt;- future.vpa(res_vpa,
                       multi=1,
                       nyear=50, # 将来予測の年数
                       start.year=2012, # 将来予測の開始年
                       N=100, # 確率的計算の繰り返し回数
                       ABC.year=2013, # ABCを計算する年
                       waa.year=2015:2017, # 生物パラメータの参照年
                       maa.year=2015:2017,
                       M.year=2015:2017,is.plot=FALSE,
                       recfunc=HS.recAR, 
                       rec.arg=list(a=HS.par0$pars$a,b=HS.par0$pars$b,
                                       rho=HS.par0$pars$rho,
                                       sd=HS.par0$pars$sd,bias.correction=TRUE,
                                    resample=TRUE,resid=HS.par0$resid),
                       rec.new=list(year=2012,rec=100),
                       pre.catch=list(year=2013,wcatch=100)
                       )
#&gt; $ABC.year
#&gt; [1] 2013
#&gt; 
#&gt; $Blim
#&gt; [1] 0
#&gt; 
#&gt; $F.sigma
#&gt; [1] 0
#&gt; 
#&gt; $Frec
#&gt; NULL
#&gt; 
#&gt; $HCR
#&gt; NULL
#&gt; 
#&gt; $M
#&gt; NULL
#&gt; 
#&gt; $M.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $N
#&gt; [1] 100
#&gt; 
#&gt; $Pope
#&gt; [1] TRUE
#&gt; 
#&gt; $add.year
#&gt; [1] 0
#&gt; 
#&gt; $currentF
#&gt; NULL
#&gt; 
#&gt; $delta
#&gt; NULL
#&gt; 
#&gt; $det.run
#&gt; [1] TRUE
#&gt; 
#&gt; $eaa0
#&gt; NULL
#&gt; 
#&gt; $faa0
#&gt; NULL
#&gt; 
#&gt; $futureF
#&gt; NULL
#&gt; 
#&gt; $is.plot
#&gt; [1] FALSE
#&gt; 
#&gt; $maa
#&gt; NULL
#&gt; 
#&gt; $maa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $multi
#&gt; [1] 1
#&gt; 
#&gt; $multi.year
#&gt; [1] 1
#&gt; 
#&gt; $naa0
#&gt; NULL
#&gt; 
#&gt; $nyear
#&gt; [1] 50
#&gt; 
#&gt; $outtype
#&gt; [1] &quot;FULL&quot;
#&gt; 
#&gt; $plus.group
#&gt; [1] TRUE
#&gt; 
#&gt; $pre.catch
#&gt; $pre.catch$year
#&gt; [1] 2013
#&gt; 
#&gt; $pre.catch$wcatch
#&gt; [1] 100
#&gt; 
#&gt; 
#&gt; $random.select
#&gt; NULL
#&gt; 
#&gt; $rec.arg
#&gt; $rec.arg$a
#&gt; [1] 0.02886733
#&gt; 
#&gt; $rec.arg$b
#&gt; [1] 51483.48
#&gt; 
#&gt; $rec.arg$rho
#&gt; [1] 0
#&gt; 
#&gt; $rec.arg$sd
#&gt; [1] 0.2580955
#&gt; 
#&gt; $rec.arg$bias.correction
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$resample
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$resid
#&gt;  [1]  0.14230780  0.12415307  0.22395093 -0.16125648  0.48770817
#&gt;  [6]  0.22824101 -0.36494355 -0.17739094 -0.03478592  0.13373274
#&gt; [11] -0.28508161  0.75317713  0.11609110  0.28599825  0.22328667
#&gt; [16] -0.01849768 -0.03555058 -0.17497213 -0.30048819  0.13086270
#&gt; [21] -0.25546420 -0.13094807  0.08889985 -0.10272350 -0.38436055
#&gt; [26] -0.34897012  0.09876784 -0.26192346 -0.12404380  0.12424438
#&gt; 
#&gt; 
#&gt; $rec.new
#&gt; $rec.new$year
#&gt; [1] 2012
#&gt; 
#&gt; $rec.new$rec
#&gt; [1] 100
#&gt; 
#&gt; 
#&gt; $recfunc
#&gt; function (ssb, vpares, rec.resample = NULL, rec.arg = list(a = 1000, 
#&gt;     b = 1000, sd = 0.1, rho = 0, resid = 0)) 
#&gt; {
#&gt;     rec0 &lt;- ifelse(ssb &gt; rec.arg$b, rec.arg$a * rec.arg$b, rec.arg$a * 
#&gt;         ssb)
#&gt;     rec &lt;- rec0 * exp(rec.arg$rho * rec.arg$resid)
#&gt;     rec &lt;- rec * exp(rnorm(length(ssb), -0.5 * rec.arg$sd2^2, 
#&gt;         rec.arg$sd))
#&gt;     new.resid &lt;- log(rec/rec0) + 0.5 * rec.arg$sd2^2
#&gt;     return(list(rec = rec, rec.resample = new.resid))
#&gt; }
#&gt; &lt;bytecode: 0x70d8ae8&gt;
#&gt; &lt;environment: namespace:frasyr&gt;
#&gt; 
#&gt; $replace.rec.year
#&gt; [1] 2012
#&gt; 
#&gt; $seed
#&gt; NULL
#&gt; 
#&gt; $silent
#&gt; [1] FALSE
#&gt; 
#&gt; $start.year
#&gt; [1] 2012
#&gt; 
#&gt; $use.MSE
#&gt; [1] FALSE
#&gt; 
#&gt; $waa
#&gt; NULL
#&gt; 
#&gt; $waa.catch
#&gt; NULL
#&gt; 
#&gt; $waa.fun
#&gt; [1] FALSE
#&gt; 
#&gt; $waa.year
#&gt; [1] 2015 2016 2017
#&gt; Warning in rec0 * exp(rec.arg$rho * rec.arg$resid): longer object length is
#&gt; not a multiple of shorter object length
</code></pre>

<h1>再生産関係を仮定しない管理基準値の計算</h1>

<ul>
<li>ref.F関数を使います</li>
<li>%SPRやFmaxなど、再生産関係を仮定しない管理基準値を計算します</li>
<li>計算結果はres_brefに格納されます</li>
<li>YPR, SPR曲線とFcurrent (<code>res_vpa$Fc.at.age</code>に入っている値です), Fmax, Fmed, F0.1などの位置が表示されます</li>
</ul>

<pre><code class="r">byear &lt;- 2015:2017 # 生物パラメータを平均する期間を2009年から2011年とする
res_bref &lt;- ref.F(res_vpa, # VPAの計算結果
                  waa.year=byear, maa.year=byear, M.year=byear, 
                  rps.year=2000:2017, # Fmedを計算するときに用いるRPSの範囲
                  max.age=Inf, # SPR計算で仮定する年齢の最大値 
                  pSPR=c(10,20,30,35,40), # F_%SPRを計算するときに，何パーセントのSPRを計算するか
                  Fspr.init=1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="図：YPR, SPR曲線"/></p>

<ul>
<li>結果のサマリーは<code>res_bref$summary</code>によって見れます</li>
<li>max: F at ageの最大値，mean: F at ageの平均値，Fref/Fcur: Fcurrentを分母にしたときのF管理基準値の比</li>
<li>この結果から，現状のF（Fcurrent）はFmedとほぼ同等（Fref/Fcur=0.96なので），F％SRP=10％くらいであることがわかります</li>
</ul>

<pre><code class="r">res_bref$summary
#&gt;           Fcurrent     Fmed     Flow     Fhigh      Fmax      F0.1
#&gt; max       1.313100 1.376519 1.622459 1.1151334 0.7291339 0.4046267
#&gt; mean      1.066667 1.118183 1.317967 0.9058531 0.5922952 0.3286892
#&gt; Fref/Fcur 1.000000 1.048297 1.235594 0.8492371 0.5552767 0.3081461
#&gt;              Fmean FpSPR.10.SPR FpSPR.20.SPR FpSPR.30.SPR FpSPR.35.SPR
#&gt; max       1.407719     1.520740    0.8750486    0.5872111    0.4915328
#&gt; mean      1.143528     1.235338    0.7108257    0.4770075    0.3992854
#&gt; Fref/Fcur 1.072057     1.158129    0.6663990    0.4471945    0.3743300
#&gt;           FpSPR.40.SPR
#&gt; max          0.4141283
#&gt; mean         0.3364076
#&gt; Fref/Fcur    0.3153821
</code></pre>

<pre><code class="r"># 横軸や縦線で示す管理基準値を調整する場合、plot_Fref関数を使う
# x.labelは res_bref$summaryの行名、vline.textは res_bref$summaryの列名前に対応させて指定する
plot_Fref(res_bref,xlabel=&quot;Fref/Fcur&quot;, vline.text=c(&quot;FpSPR.20.SPR&quot;,&quot;FpSPR.30.SPR&quot;,&quot;FpSPR.40.SPR&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="図：YPR, SPR曲線 (x軸などを変更した場合)"/></p>

</body>

</html>
